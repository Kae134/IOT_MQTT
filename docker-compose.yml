services:
  bridge:
    build: ./bridge
    container_name: iot-bridge
    ports:
      - "8080:8080"
    environment:
      - MQTT_BROKER_URL=${MQTT_BROKER_URL:-mqtt://captain.dev0.pandor.cloud:1884}
      - MQTT_TOPIC_PATTERN=${MQTT_TOPIC_PATTERN:-classroom/+/telemetry}
      - WS_PORT=8080
      - NODE_ENV=production
    restart: unless-stopped
    networks:
      - iot-network

  front:
    build: ./front
    container_name: iot-front
    ports:
      - "5173:5173"
    depends_on:
      - bridge
    restart: unless-stopped
    networks:
      - iot-network

networks:
  iot-network:
    driver: bridge
